{% extends 'base.html.twig' %}

{% block body %}
    <div id="wrapper">
        <div id="container">
            <div id="welcome">
                <h1><span>Welcome to</span> Bonds {{ principal }}</h1>
            </div>

            {#<div id="linechart"></div>#}
            {#<div id="linechart50000"></div>#}

            <div id="serieslabelspercent"></div>
            <div id="serieslabels"></div>

            {#<div id="irregular"></div>#}

        </div>
    </div>
{% endblock %}

{% block stylesheets %}
    <style>
        body { background: #F5F5F5; font: 18px/1.5 sans-serif; }
        h1, h2 { line-height: 1.2; margin: 0 0 .5em; }
        h1 { font-size: 36px; }
        h2 { font-size: 21px; margin-bottom: 1em; }
        p { margin: 0 0 1em 0; }
        a { color: #0000F0; }
        a:hover { text-decoration: none; }
        code { background: #F5F5F5; max-width: 100px; padding: 2px 6px; word-wrap: break-word; }
        #linechart { min-width: 400px; height: 400px; margin: 0 auto; }
    </style>
{% endblock %}

{% block javascripts %}
    {#<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>#}
    {#<script src="https://code.highcharts.com/highcharts.js"></script>#}
    {#<script src="https://code.highcharts.com/modules/series-label.js"></script>#}
    {#<script src="https://code.highcharts.com/modules/exporting.js"></script>#}
    <script src="{{ asset("js/jquery-3.3.1.min.js") }}"></script>
    <script src="{{ asset("js/highcharts-6.0.6/highcharts.js") }}"></script>
    <script src="{{ asset("js/highcharts-6.0.6/modules/boost.js") }}"></script>
    <script src="{{ asset("js/highcharts-6.0.6/modules/series-label.js") }}"></script>
    <script type="text/javascript">
        $(document).ready(function() {

            Highcharts.chart('serieslabels', {
                chart: {
                    type: 'spline'
                },
                title: {
                    text: 'Bonds evolution for {{ principal|e('js') }}'
                },
                subtitle: {
                    text: 'Amount: {{ initialValue|e('js') }} {{ currency|e('js') }} - Period: {{ periodStart|e('js') }} - {{ periodEnd|e('js') }}'
                },
                xAxis: {
                    type: 'datetime',
                    dateTimeLabelFormats: { // don't display the dummy year
                        month: '%e. %b %y',
                        year: '%b'
                    },
                    title: {
                        text: 'Date'
                    }
                },
                yAxis: {
                    title: {
                        text: 'Profit ({{ currency }})'
                    },
                    plotLines: [{
                        color:'#000000',
                        value: 0,
                        width: 2
                    }],
                    softMin: 0
                    //min: 0
                },
                tooltip: {
                    headerFormat: '<b>{series.name}</b><br>',
                    pointFormat: '{point.x:%e. %b %y}: {point.y:.2f} {{ currency|e('js') }}'
                },

                plotOptions: {
                    spline: {
                        marker: {
                            enabled: true
                        }
                    }
                },

                series: [{
                    name: '{{ principal|e('js') }}',
                    data: {{ evolutionSeries|json_encode }}
                }]
            });

            Highcharts.chart('serieslabelspercent', {
                chart: {
                    type: 'spline'
                },
                title: {
                    text: 'Bonds profit evolution for {{ principal|e('js') }}'
                },
                subtitle: {
                    text: 'Amount: {{ initialValue|e('js') }} {{ currency|e('js') }} - Period: {{ periodStart|e('js') }} - {{ periodEnd|e('js') }}'
                },
                xAxis: {
                    type: 'datetime',
                    dateTimeLabelFormats: { // don't display the dummy year
                        month: '%e. %b %y',
                        year: '%b'
                    },
                    title: {
                        text: 'Date'
                    }
                },
                yAxis: {
                    title: {
                        text: 'Profit ratio (%)'
                    },
                    plotLines: [{
                        color:'#000000',
                        value: 0,
                        width: 2
                    }],
                    softMin: 0
                    //min: 0
                },
                tooltip: {
                    useHTML: true,
                    formatter: function() {
                        return '<b>' + this.series.name + '</b><br />'
                            + Highcharts.dateFormat('%e. %b %y', this.x) + ': <b>' + Highcharts.numberFormat(this.y, 2) + '%</b><br />'
                            + this.point.z +' {{ currency|e('js') }}'
                        ;
                    }
                },

                plotOptions: {
                    spline: {
                        marker: {
                            enabled: true
                        }
                    }
                },

                series: [{
                    name: '{{ principal|e('js') }} Profit Ratio',
                    data: {{ percentSeries|json_encode|raw }}
                }]
            });
        });
    </script>
{% endblock %}
